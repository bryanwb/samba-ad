# This is the main Samba configuration file.
#
# It was dynamically generated by Chef on <%= node["fqdn"] %>
#
# Local modifications will be overwritten by Chef.
#

[global]
workgroup = <%= node["samba"]["workgroup"] %>
nameresolveorder = hosts wins bcast
password server = <%= node['samba']['passwd_servers'].join(' ') %> 
<% if node['samba']['realm'] %>
<%= "realm	= " + node['samba']['realm'] %>	
<% end %>
logfile = <%= node["samba"]["log_dir"] %>
clientntlmv2auth = yes
maxlogsize = 1500
usernamemap = /etc/samba/smbusers
server string = <%= node["samba"]["server_string"] %>
security = <%= node["samba"]["security"] %>
interfaces = <%= node["samba"]["interfaces"] %>
hosts allow = <%= node["samba"]["hosts_allow"] %>
load printers = <%= node["samba"]["load_printers"] %>
<% if node['samba']['passdb_backend'] != "none" %>
<%= "passdb backend = " + node["samba"]["passdb_backend"] %>
<% end %>
dns proxy = <%= node["samba"]["dns_proxy"] %>

#============================ Share Definitions ==============================
<% @shares.each do |share| -%>
[<%= share['id'] %>]
  <% share.each do |o,v| -%>
		<% if o != 'id' %>
		  <%= o %> = <%= v.respond_to?(:join) ? v.join(',') : v %>
		  <% end -%>
		<% end -%>

<% end -%>
